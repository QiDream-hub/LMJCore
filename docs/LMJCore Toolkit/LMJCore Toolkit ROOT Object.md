# LMJCore Toolkit:ROOT **Object**
## 根对象 (Root Object)

**本质：** 根对象是一个类型为 `LMJCORE_OBJ` 的**普通对象**。这意味着它在 `main` 库和 `arr` 库中的存储方式与任何其他对象完全相同。

**特殊性：** 它的特殊性仅源于其在系统中的地位和生命周期管理：
1. **系统入口：** 它是整个数据域的唯一、稳定的顶级入口。所有不隶属于任何其他业务对象的数据（如全局配置、索引表头）都应作为其成员存储。
2. **初始化创建：** 它由 `lmjcore_root_init` 函数在系统初始化后**用户调用创建**（或连接到已存在的）。
3. **外部可知性与持久化：** 内核提供 `lmjcore_get_root_pointer` 函数来获取其指针。
## 一、Root 对象指针规范

### 1. 核心特性
- **不可变性**：一旦初始化完成，Root 对象的指针在其生命周期内**绝对不可改变**。
- **外部可知性**：Root 指针必须对上层应用可知，且获取成本极低。

### 2. 管理策略
- **初始化指定**：系统初始化时，由上层应用通过 `lmjcore_root_init` 函数显式传入一个符合 `Object` 类型的 17 字节指针。
- **持久化**：该指针由本包注册的root对象成员root存储
- **如何获取**: 在本包注册的root对象下有一个key对象,该对象的指针使用一个固定指针指向(未定义)
- **本包提供接口**：本包提供 `lmjcore_get_root_pointer` 函数，用于获取当前使用的 Root 指针二进制值。

## 二、根对象初始化流程

### 1. 单次初始化原则
- 本包定义**一个LMJCore实例在其生命周期内只能有一个根对象**。因此，**根对象的初始化流程不可重复执行**。
- 在打开内核环境后应立刻执行`lmjcore_root_init`进行root对象的初始化，初始化时会检查root对象是否存在如果不存在，`lmjcore_root_init`将在第一个写事务中创建该根对象；如果已存在，则检查指针是否与当前根对象指针相同，是则连接数据库；否则返回当前根对象的指针。

### 2. 行为明确化
- 在实例已初始化后，再次调用 `lmjcore_root_init` 并传入**相同的根指针**，应视为无操作（NO-OP）并返回成功。
- 在实例已初始化后，再次调用 `lmjcore_root_init` 并传入**不同的根指针**，应视为**严重错误**，函数必须失败并返回错误码，以防止意外切换到另一个数据域。